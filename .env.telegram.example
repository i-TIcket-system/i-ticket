# Telegram Bot Configuration
# Add these variables to your .env.production file

# ==================== REQUIRED VARIABLES ====================

# Telegram Bot Token (from @BotFather)
# Example: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_BOT_TOKEN=your-bot-token-here

# Enable/disable Telegram bot
# Set to "true" to enable, "false" to disable
TELEGRAM_BOT_ENABLED=false

# Webhook secret token for security
# Generate with: openssl rand -hex 32
TELEGRAM_WEBHOOK_SECRET=your-webhook-secret-here

# ==================== OPTIONAL VARIABLES ====================

# Site URL (defaults to https://i-ticket.et in production)
# Used for webhook URL construction
NEXT_PUBLIC_SITE_URL=https://i-ticket.et

# ==================== SETUP INSTRUCTIONS ====================

# 1. Create Bot with @BotFather:
#    - Send /newbot to @BotFather
#    - Choose bot name: "i-Ticket Bus Booking"
#    - Choose username: "iticket_et_bot" (or similar)
#    - Copy the bot token

# 2. Generate Webhook Secret:
#    openssl rand -hex 32

# 3. Add to .env.production:
#    TELEGRAM_BOT_TOKEN="your-token"
#    TELEGRAM_BOT_ENABLED="true"
#    TELEGRAM_WEBHOOK_SECRET="your-secret"

# 4. Run Database Migration:
#    npx prisma migrate dev --name add_telegram_session
#    npx prisma generate

# 5. Deploy & Setup Webhook:
#    npm run build
#    pm2 restart i-ticket
#    tsx scripts/telegram-setup-webhook.ts

# 6. Test Bot:
#    Open Telegram → Search for your bot → Send /start

# ==================== TROUBLESHOOTING ====================

# Bot not responding:
#   - Check PM2 status: pm2 status i-ticket
#   - Check logs: pm2 logs i-ticket | grep TELEGRAM
#   - Verify webhook: curl "https://api.telegram.org/bot<TOKEN>/getWebhookInfo"

# Sessions not persisting:
#   - Verify database migration ran
#   - Check TelegramSession table exists
#   - Verify PostgreSQL connection

# To disable bot:
#   - Set TELEGRAM_BOT_ENABLED=false
#   - Restart: pm2 restart i-ticket
#   - Delete webhook: curl -X POST "https://api.telegram.org/bot<TOKEN>/deleteWebhook"
