# i-Ticket Platform - Compliance and Regulatory Requirements

**Document**: 5.4.7 - Compliance and Regulatory Requirements
**Prepared for**: INSA Cyber Security Audit Division
**Application**: i-Ticket Online Bus Ticketing Platform
**URL**: https://i-ticket.et
**Version**: v2.14.0
**Date**: February 2026

---

## 1. Applicable Regulatory Frameworks

### 1.1 Ethiopian Regulations

| Regulation | Applicability | Compliance Status |
|------------|---------------|-------------------|
| **INSA Cybersecurity Framework** | Web application security requirements for .et domains | Under audit (this submission) |
| **Ethiopian Data Protection Proclamation** | Personal data processing requirements | Compliant (see Section 2) |
| **National Bank of Ethiopia (NBE) Directives** | Payment service provider regulations | Compliant via TeleBirr (licensed PSP) |
| **Ethiopian Communications Authority (ECA)** | Telecommunications and SMS regulations | Compliant via licensed SMS gateway |
| **Ethiopian Revenue and Customs Authority (ERCA)** | VAT collection and reporting | Compliant (15% VAT on commission) |
| **Federal Transport Authority** | Bus transport regulations | Bus companies hold individual licenses |

### 1.2 International Standards (Referenced)

| Standard | Relevance | Implementation Level |
|----------|-----------|---------------------|
| **OWASP Top 10 (2021)** | Web application security baseline | Fully addressed (see Section 3) |
| **OWASP Secure Coding Practices** | Development guidelines | Adopted as coding standard |
| **ISO/IEC 27001** | Information security management | Principles applied (not certified) |
| **PCI DSS** | Payment card data security | Not applicable (no card data stored — TeleBirr handles payment processing) |
| **NIST Cybersecurity Framework** | Risk management | Risk-based approach adopted |

---

## 2. Data Protection Compliance

### 2.1 Personal Data Inventory

| Data Category | Fields | Legal Basis | Retention |
|---------------|--------|-------------|-----------|
| **Identity** | Name, phone, email | Service delivery (contract) | Account lifetime |
| **National ID** | nationalId | Passenger verification (legal obligation) | Account lifetime |
| **Authentication** | Password hash | Account security (contract) | Until password change |
| **Financial** | Payment amount, transaction ID | Payment processing (contract) | Permanent (audit trail) |
| **Travel** | Trip bookings, tickets | Service delivery (contract) | Permanent (business record) |
| **Location** | GPS coordinates (driver tracking) | Service delivery (real-time tracking) | 7 days (auto-purged by cron) |
| **Communication** | SMS content, Telegram session | Service delivery (notifications) | SMS: not stored; Telegram: 30-min session |
| **Audit** | AdminLog entries | Security and compliance | Permanent |
| **Banking** | Company bank account, branch | Company settlement (contract) | Account lifetime |

### 2.2 Data Minimization

| Principle | Implementation |
|-----------|---------------|
| Collect only necessary data | Guest users: phone only. Registered: name + phone + optional email |
| Limit data in tokens | JWT contains: id, role, companyId, staffRole (no passwords, no national IDs) |
| Limit data in responses | Ticket verification hides `bookedByPhone`. Error responses hide internal details |
| Limit data in SMS | Short codes + route + time only (no financial details, no national IDs) |
| GPS data purge | GPS positions auto-deleted after 7 days for completed/cancelled trips |
| Session cleanup | Telegram sessions: 30-min timeout. SMS sessions: 5-min timeout |

### 2.3 Data Subject Rights

| Right | Implementation |
|-------|---------------|
| **Access** | Users can view all their bookings, tickets, and profile via the portal |
| **Rectification** | Users can update their profile (name, email, phone, national ID) |
| **Deletion** | Account deletion available upon request (contact support) |
| **Data portability** | Booking history and tickets available for download |
| **Objection to processing** | Users can contact support to object to data processing |

### 2.4 Consent

| Scenario | Consent Mechanism |
|----------|-------------------|
| Account creation | Explicit registration action (filling form + clicking register) |
| Guest booking | Implicit consent via phone payment (phone number = identity + consent) |
| SMS notifications | Consent implied by booking (notifications are part of service delivery) |
| Telegram bot | User initiates interaction by messaging the bot |
| GPS tracking | Driver activates tracking manually (explicit opt-in per trip) |
| Analytics | Cloudflare Web Analytics: no cookies, no PII (no consent required) |

---

## 3. OWASP Top 10 (2021) Compliance

### A01:2021 — Broken Access Control

| Control | Implementation |
|---------|---------------|
| Role-based access control | 4 primary roles + 7 staff sub-roles |
| Company segregation | Every company API filters by `companyId` from session |
| Resource ownership | Users can only access their own bookings/tickets |
| Admin privilege separation | `requireFullAdmin()` blocks supervisors from sensitive settings |
| View-only trip states | DEPARTED/COMPLETED/CANCELLED trips are read-only |
| Function-level access control | Auth helpers enforce roles per route handler |

### A02:2021 — Cryptographic Failures

| Control | Implementation |
|---------|---------------|
| Password hashing | bcrypt with 12 salt rounds |
| TLS in transit | TLS 1.2+ enforced via Cloudflare |
| HMAC signatures | SHA-256 for TeleBirr payment verification |
| Timing-safe comparison | `crypto.timingSafeEqual()` for all cryptographic comparisons |
| Secret management | Environment variables, not in code; validated at startup |
| **Gap** | No field-level encryption at rest for nationalId, bankAccount (recommended) |
| **Gap** | No database encryption at rest (AWS EBS encryption available but not enabled) |

### A03:2021 — Injection

| Control | Implementation |
|---------|---------------|
| SQL injection | Prisma ORM exclusively — zero raw SQL queries in codebase |
| XSS | React 18 auto-escaping + CSP headers + Zod input validation |
| Command injection | No shell command execution from user input |
| Path traversal | System-generated filenames, no user-controlled file paths |

### A04:2021 — Insecure Design

| Control | Implementation |
|---------|---------------|
| Threat modeling | Trust boundaries documented (DFD Level 0/1/2) |
| Business logic protection | RULES.md with mandatory rules, Bug Registry |
| Rate limiting | Per-endpoint rate limits for all mutation endpoints |
| Payment amount verification | Server-side recalculation (never trusts client amounts) |
| Race condition prevention | `SELECT FOR UPDATE NOWAIT` + transaction timeouts |

### A05:2021 — Security Misconfiguration

| Control | Implementation |
|---------|---------------|
| Security headers | CSP, HSTS, X-Frame-Options, X-Content-Type-Options, Referrer-Policy |
| Error handling | Generic error messages in production (no stack traces, SQL, file paths) |
| Unnecessary features | Cloudflare Email Obfuscation disabled, Rocket Loader disabled |
| Default credentials | `mustChangePassword` flag for staff accounts with temp passwords |
| **Gap** | `unsafe-inline` in CSP script-src (Next.js 14 limitation) |

### A06:2021 — Vulnerable and Outdated Components

| Control | Implementation |
|---------|---------------|
| Dependency management | npm with `package-lock.json` for deterministic installs |
| Vulnerability scanning | GitHub Dependabot automated alerts |
| Runtime versions | Node.js 20 LTS, PostgreSQL 16, Ubuntu 22.04 LTS — all actively supported |
| Known overrides | `glob: ^10.5.0` security patch applied |
| Resolution status | 6 of 7 Dependabot alerts resolved as of v2.13.0 |

### A07:2021 — Identification and Authentication Failures

| Control | Implementation |
|---------|---------------|
| Brute force protection | Rate limiting: 5 login attempts per 15 min (per phone), 10 per IP |
| Password strength | Minimum 8 chars, uppercase + lowercase + digit required |
| Credential storage | bcrypt (12 rounds), plaintext never stored |
| Session management | httpOnly, secure, sameSite cookies; 30-day expiry |
| User enumeration | Same error for wrong phone and wrong password |
| **Gap** | No multi-factor authentication (MFA/2FA) |
| **Gap** | No JWT revocation mechanism |

### A08:2021 — Software and Data Integrity Failures

| Control | Implementation |
|---------|---------------|
| Dependency integrity | `package-lock.json` lockfile, `npm ci` for production |
| Webhook verification | HMAC-SHA256 for TeleBirr callbacks, Telegram secret header |
| Payment integrity | Server-side amount recalculation, replay protection |
| Code integrity | Git version control, deployment from specific branch |

### A09:2021 — Security Logging and Monitoring Failures

| Control | Implementation |
|---------|---------------|
| Audit logging | AdminLog table records all sensitive operations |
| Application logs | PM2 process manager with log rotation |
| CSP violation reports | `/api/csp-report` endpoint, logged to PM2 |
| Cloudflare analytics | Traffic monitoring, DDoS alerting |
| **Gap** | No centralized SIEM integration |
| **Gap** | No automated alert system for security events |

### A10:2021 — Server-Side Request Forgery (SSRF)

| Control | Implementation |
|---------|---------------|
| No user-controlled URLs | All external API URLs are hardcoded (TeleBirr, SMS, Telegram) |
| No URL parameters | No endpoints accept URLs as input parameters |
| Internal services | Database on localhost (not network-exposed) |

---

## 4. Financial Compliance

### 4.1 VAT Compliance

| Property | Value |
|----------|-------|
| VAT Rate | 15% (Ethiopian standard rate) |
| Applied to | Platform commission (5% of ticket price) |
| Calculation | `commission = ticketPrice × 0.05; vat = commission × 0.15; total = commission + vat` |
| Example | 850 ETB ticket → 42.50 commission + 6.38 VAT = 48.88 ETB total charge |
| Reporting | Tax reports available via `/api/admin/tax-reports` |

### 4.2 Payment Processing

| Property | Value |
|----------|-------|
| Payment processor | TeleBirr (Ethio Telecom — licensed PSP) |
| Card data storage | None (i-Ticket never handles card/bank details) |
| PCI DSS scope | Out of scope (payment handled entirely by TeleBirr) |
| Transaction records | All payments logged with transaction IDs, amounts, statuses |
| Refund policy | Managed by bus companies (not platform-level) |
| Settlement | Company receives ticket price minus platform commission |

### 4.3 Commission Transparency

| Item | Visibility |
|------|------------|
| Platform commission (5%) | Shown to customer as breakdown before payment |
| VAT on commission (15%) | Shown to customer as breakdown before payment |
| TeleBirr fee (0.5%) | Absorbed by i-Ticket — invisible to customer |
| Total customer price | `ticketPrice + commission + VAT` |
| Company settlement | `ticketPrice` (full amount minus platform fee) |

---

## 5. Transport Sector Compliance

### 5.1 Passenger Manifest Requirements

| Requirement | Implementation |
|-------------|---------------|
| Passenger list | Auto-generated manifests on departure or full capacity |
| Passenger identification | Name, phone (national ID collected but not in manifest) |
| Boarding verification | QR code ticket scanning, boarding status tracking |
| Download format | PDF and Excel manifests available for company admins |
| Retention | Manifests retained permanently (linked to Trip records) |

### 5.2 Vehicle Safety

| Requirement | Implementation |
|-------------|---------------|
| Vehicle inspection | Pre-trip, post-trip, daily, weekly, annual, safety inspections |
| Risk scoring | AI-based risk scoring (0-100) for each vehicle |
| Pre-departure check | High-risk vehicles (score >= 85) require recent inspection before departure |
| Insurance tracking | Insurance expiry date tracked per vehicle |
| Registration tracking | Registration expiry date tracked per vehicle |
| Compliance calendar | Upcoming due dates for inspections, renewals |

---

## 6. Telecommunications Compliance

### 6.1 SMS Communications

| Requirement | Implementation |
|-------------|---------------|
| Licensed gateway | SMS sent via licensed Ethiopian SMS gateway provider |
| Content restrictions | Operational messages only (booking, payment, reminders) |
| Opt-out | Contact support to stop SMS notifications |
| No marketing | No unsolicited marketing SMS sent |
| Phone format | Ethiopian phone format validated (09/07 prefix) |

### 6.2 Telegram Bot

| Requirement | Implementation |
|-------------|---------------|
| Bot registration | Registered with Telegram via @BotFather |
| User initiation | Users must message the bot first (no unsolicited messages) |
| Data handling | Minimal data stored (session expires in 30 minutes) |
| Language support | English and Amharic |

---

## 7. Privacy Policy and Terms

### 7.1 Published Policies

| Document | URL | Content |
|----------|-----|---------|
| Privacy Policy | `https://i-ticket.et/privacy` | Data collection, usage, retention, rights |
| Terms of Service | `https://i-ticket.et/terms` | Service terms, booking conditions, liability |
| FAQ | `https://i-ticket.et/faq` | Common questions including privacy, payments |

### 7.2 Key Privacy Disclosures

- Data collected: name, phone, email, booking history, GPS (drivers only)
- Third parties: TeleBirr (payments), SMS gateway (notifications)
- Retention: account data retained until deletion; GPS data purged after 7 days
- Security: encryption in transit (TLS), access controls, audit logging
- Contact: +251 911 550 001

---

## 8. Compliance Gaps and Remediation Plan

| Gap | Risk | Priority | Recommended Remediation |
|-----|------|----------|------------------------|
| No field-level encryption for national IDs | Medium | High | Implement AES-256 encryption for `nationalId`, `bankAccount` fields |
| No database encryption at rest | Medium | Medium | Enable AWS EBS encryption on database volume |
| No MFA for admin accounts | Medium | High | Implement TOTP-based MFA for SUPER_ADMIN and COMPANY_ADMIN roles |
| No SIEM integration | Low | Medium | Integrate AdminLog with centralized logging service |
| `unsafe-inline` in CSP | Low | Medium | Upgrade to Next.js 15+ for nonce-based CSP |
| JWT has no revocation | Low | Low | Implement token version counter or database session store |
| No automated security alerts | Low | Medium | Set up alert rules for failed login spikes, unusual API patterns |

---

*End of Document 5.4.7 - Compliance and Regulatory Requirements*
