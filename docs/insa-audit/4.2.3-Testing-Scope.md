# i-Ticket Platform - Testing Scope Definition

**Document**: 4.2.3 - Define Specific Testing Scope
**Prepared for**: INSA Cyber Security Audit Division
**Application**: i-Ticket Online Bus Ticketing Platform
**URL**: https://i-ticket.et
**Version**: v2.14.0
**Date**: February 2026

---

## 1. Assets in Scope

| # | Asset Name | URL / IP Address | Type | Description |
|---|-----------|-----------------|------|-------------|
| 1 | **Public Web Portal** | https://i-ticket.et | Web Application | Customer-facing booking platform (search, book, pay, track) |
| 2 | **Admin Dashboard** | https://i-ticket.et/admin/* | Web Application | Super Admin platform management portal |
| 3 | **Company Portal** | https://i-ticket.et/company/* | Web Application | Bus company management (trips, staff, fleet, reports) |
| 4 | **Driver Portal** | https://i-ticket.et/driver/* | Web Application | Driver GPS tracking page |
| 5 | **Cashier Portal** | https://i-ticket.et/cashier/* | Web Application | Manual ticket sales portal |
| 6 | **Mechanic Portal** | https://i-ticket.et/mechanic/* | Web Application | Vehicle inspection and work order portal |
| 7 | **Finance Portal** | https://i-ticket.et/finance/* | Web Application | Financial reports portal |
| 8 | **Sales Portal** | https://i-ticket.et/sales/* | Web Application | Sales referral and commission portal |
| 9 | **REST API** | https://i-ticket.et/api/* | API | All backend API endpoints (see Section 3) |
| 10 | **Telegram Bot** | https://t.me/i_ticket_busBot | Bot | Bilingual booking bot (@i_ticket_busBot) |
| 11 | **Telegram Webhook** | https://i-ticket.et/api/telegram/webhook | API Webhook | Telegram bot update receiver |
| 12 | **SMS Webhook** | https://i-ticket.et/api/sms/incoming | API Webhook | Inbound SMS booking receiver |
| 13 | **TeleBirr Callback** | https://i-ticket.et/api/payments/telebirr/callback | API Webhook | Payment callback endpoint |
| 14 | **Origin Server** | 54.147.33.168 | EC2 Instance | AWS EC2 t2.micro (Ubuntu 22.04) |
| 15 | **Service Worker** | https://i-ticket.et/sw.js | PWA | Progressive web app service worker |
| 16 | **Manifest** | https://i-ticket.et/manifest.json | PWA | Web app manifest for installable PWA |

---

## 2. Test Account Credentials

### 2.1 Web Application Accounts

| # | Role | Phone | Password | Portal URL | Capabilities |
|---|------|-------|----------|-----------|-------------|
| 1 | **Super Admin** | 0911223344 | demo123 | /admin/* | Full platform access: all companies, system analytics, user management, audit logs, tax reports, platform staff |
| 2 | **Company Admin** (Selam Bus) | 0922345678 | demo123 | /company/* | Full company management: trips, staff, vehicles, fleet analytics, reports, boarding management |
| 3 | **Customer** | 0912345678 | demo123 | /(customer)/* | Search trips, book tickets, view tickets, track bus, manage profile |
| 4 | **Guest Customer** | Any 09XXXXXXXX | N/A | / | Book without registration (phone at booking = identity) |

### 2.2 Staff Sub-Role Accounts

> Staff accounts are created by Company Admins within the Selam Bus company. Log in with Company Admin credentials to access the staff management page and view/create staff accounts with these sub-roles:

| Staff Role | Portal | Capabilities to Test |
|------------|--------|---------------------|
| **DRIVER** | /driver/track | GPS tracking, trip departure, odometer entry |
| **CONDUCTOR** | /company/* | Ticket verification (QR scan), boarding checklist |
| **MANUAL_TICKETER** | /cashier/* | Manual ticket sales, replacement ticket sales |
| **MECHANIC** | /mechanic/* | Work orders, vehicle inspections |
| **FINANCE** | /finance/* | Financial reports, cost tracking |

### 2.3 Telegram Bot Account

| Bot | Username | How to Test |
|-----|----------|-------------|
| i-Ticket Bus Bot | @i_ticket_busBot | Open https://t.me/i_ticket_busBot, send `/start`, follow booking flow |

### 2.4 External System Test Credentials

| System | Test Mode | Notes |
|--------|-----------|-------|
| **TeleBirr** | DEMO_MODE=true on staging | Demo mode simulates payment success; production uses real TeleBirr API |
| **SMS Gateway** | N/A | Real SMS delivery; test with valid Ethiopian phone numbers |
| **Cron Jobs** | Bearer token: CRON_SECRET env var | Test via `GET /api/cron/cleanup` with `Authorization: Bearer {CRON_SECRET}` |

---

## 3. API Endpoints in Scope

### 3.1 Public Endpoints (No Authentication)

| # | Method | Endpoint | Purpose | Rate Limit |
|---|--------|----------|---------|------------|
| 1 | GET | `/api/trips` | Search available trips | Nginx 100r/m |
| 2 | GET | `/api/trips/[id]` | Get trip details | Nginx 100r/m |
| 3 | POST | `/api/bookings` | Create booking (guest allowed) | 10/min/IP |
| 4 | GET | `/api/track/[code]` | Public ticket/booking tracking | Nginx 100r/m |
| 5 | GET | `/api/cities` | List all cities | Nginx 100r/m |
| 6 | GET | `/api/cities/coordinates` | City lat/lon for maps | Nginx 100r/m |
| 7 | POST | `/api/auth/register` | User registration | 3/hour/IP |
| 8 | POST | `/api/auth/[...nextauth]` | Login (NextAuth) | 5/30min/phone, 10/15min/IP |
| 9 | POST | `/api/auth/forgot-password` | Password reset request | 3/hour/IP |
| 10 | POST | `/api/auth/reset-password` | Password reset with token | Nginx 100r/m |
| 11 | POST | `/api/support/tickets` | Create support ticket | Nginx 100r/m |
| 12 | GET | `/api/tracking/[tripId]` | Passenger bus tracking (DEPARTED trips) | Nginx 100r/m |
| 13 | POST | `/api/csp-report` | CSP violation reports | Nginx 100r/m |

### 3.2 Authenticated Endpoints (JWT Session Required)

#### Customer Endpoints

| # | Method | Endpoint | Purpose | Auth Role |
|---|--------|----------|---------|-----------|
| 14 | POST | `/api/payments` | Initiate payment | CUSTOMER / COMPANY_ADMIN |
| 15 | GET | `/api/bookings/my` | List user's bookings | CUSTOMER |
| 16 | GET | `/api/notifications` | User notifications | Any authenticated |
| 17 | PATCH | `/api/notifications/[id]` | Mark notification read | Any authenticated |
| 18 | POST | `/api/auth/force-change-password` | Change temp password | COMPANY_ADMIN (mustChangePassword) |

#### Company Admin Endpoints

| # | Method | Endpoint | Purpose |
|---|--------|----------|---------|
| 19 | GET/POST | `/api/company/trips` | List / create trips |
| 20 | GET/PUT/DELETE | `/api/company/trips/[id]` | Get / update / delete trip |
| 21 | PATCH | `/api/company/trips/[id]/status` | Change trip status |
| 22 | POST | `/api/company/trips/[id]/depart` | Mark trip DEPARTED |
| 23 | POST | `/api/company/trips/[id]/complete` | Mark trip COMPLETED |
| 24 | GET | `/api/company/trips/[id]/boarding-status` | Get boarding checklist |
| 25 | POST | `/api/company/trips/[id]/no-show` | Mark passengers NO_SHOW |
| 26 | POST | `/api/company/trips/[id]/replacement-ticket` | Sell replacement ticket |
| 27 | GET/POST | `/api/company/trip-templates` | Trip template CRUD |
| 28 | GET/POST | `/api/company/staff` | Staff management |
| 29 | GET/PUT | `/api/company/staff/[id]` | Staff detail/update |
| 30 | GET/POST | `/api/company/vehicles` | Vehicle management |
| 31 | GET/PUT | `/api/company/vehicles/[id]` | Vehicle detail/update |
| 32 | GET/POST | `/api/company/vehicles/[id]/inspections` | Vehicle inspections |
| 33 | GET/POST | `/api/company/vehicles/[id]/fuel` | Fuel entries |
| 34 | GET/POST | `/api/company/work-orders` | Work order management |
| 35 | GET/PUT | `/api/company/work-orders/[id]` | Work order detail/update |
| 36 | GET | `/api/company/analytics/fleet-health` | Fleet health dashboard |
| 37 | GET | `/api/company/analytics/risk-trends` | Risk trend charts |
| 38 | GET | `/api/company/analytics/failure-timeline` | Failure predictions |
| 39 | GET | `/api/company/analytics/cost-forecast` | Cost forecasting |
| 40 | GET | `/api/company/analytics/vehicle-comparison` | Vehicle comparisons |
| 41 | GET | `/api/company/analytics/maintenance-windows` | Maintenance scheduling |
| 42 | GET | `/api/company/analytics/route-wear` | Route wear analysis |
| 43 | GET | `/api/company/analytics/compliance-calendar` | Compliance tracking |
| 44 | GET | `/api/company/reports/maintenance` | Maintenance cost report |
| 45 | GET | `/api/company/reports/maintenance/export` | Export to Excel |
| 46 | GET | `/api/company/reports/vehicle-tco` | Total cost of ownership |
| 47 | GET | `/api/company/reports/downtime` | Downtime report |
| 48 | GET | `/api/company/reports/fleet-analytics/export` | Fleet analytics export |
| 49 | GET | `/api/company/bookings` | Company bookings list |
| 50 | GET | `/api/company/manifests` | Manifest downloads |
| 51 | GET | `/api/company/messages` | Company-platform chat |
| 52 | POST | `/api/company/messages` | Send message to platform |
| 53 | GET | `/api/company/audit-logs` | Company audit log |
| 54 | GET | `/api/company/notifications` | Company notifications |

#### GPS Tracking Endpoints

| # | Method | Endpoint | Purpose | Auth |
|---|--------|----------|---------|------|
| 55 | POST | `/api/tracking/update` | Driver GPS position | Session (DRIVER/CONDUCTOR) |
| 56 | GET | `/api/tracking/osmand` | OsmAnd background GPS | Token (trackingToken) |
| 57 | GET | `/api/tracking/fleet` | Fleet map (all buses) | Session (COMPANY_ADMIN) |
| 58 | POST | `/api/tracking/generate-token` | OsmAnd token generation | Session (DRIVER) |
| 59 | GET | `/api/tracking/active-trip` | Driver's active trip | Session (DRIVER) |

#### Ticket Verification

| # | Method | Endpoint | Purpose | Auth |
|---|--------|----------|---------|------|
| 60 | PATCH | `/api/tickets/verify` | Verify + mark ticket used | Session (COMPANY_ADMIN / SUPER_ADMIN) |

#### Super Admin Endpoints

| # | Method | Endpoint | Purpose |
|---|--------|----------|---------|
| 61 | GET | `/api/admin/stats` | Platform dashboard stats |
| 62 | GET/POST | `/api/admin/companies` | Company management |
| 63 | GET/PUT | `/api/admin/companies/[id]` | Company detail/update |
| 64 | POST | `/api/admin/companies/[id]/setup-staff` | Create company admin |
| 65 | GET | `/api/admin/trips` | All trips (cross-company) |
| 66 | GET | `/api/admin/bookings` | All bookings with filters |
| 67 | GET | `/api/admin/manifests` | All manifests |
| 68 | GET | `/api/admin/audit-logs` | Full audit trail |
| 69 | GET/POST | `/api/admin/platform-staff` | Platform staff CRUD |
| 70 | GET/POST | `/api/admin/sales-persons` | Sales person management |
| 71 | GET | `/api/admin/tax-reports` | Revenue/tax analytics |
| 72 | GET | `/api/admin/analytics/revenue` | Revenue analytics |
| 73 | GET | `/api/admin/analytics/top-companies` | Top companies |
| 74 | GET | `/api/admin/analytics/top-routes` | Top routes |
| 75 | GET | `/api/admin/analytics/monthly-trends` | Monthly trends |
| 76 | GET | `/api/admin/messages` | All company messages |
| 77 | POST | `/api/admin/messages` | Send message to company |

### 3.3 Webhook / Callback Endpoints

| # | Method | Endpoint | Auth Method | Source |
|---|--------|----------|-------------|--------|
| 78 | POST | `/api/payments/telebirr/callback` | HMAC-SHA256 signature | TeleBirr |
| 79 | POST | `/api/telegram/webhook` | Telegram-signed | Telegram API |
| 80 | POST | `/api/sms/incoming` | HMAC-SHA256 (SMS_WEBHOOK_SECRET) | SMS Gateway |

### 3.4 Cron / Scheduled Endpoints

| # | Method | Endpoint | Auth | Schedule |
|---|--------|----------|------|----------|
| 81 | GET | `/api/cron/cleanup` | Bearer (CRON_SECRET) | Every 15 min |
| 82 | GET | `/api/cron/trip-reminders` | Bearer (CRON_SECRET) | Scheduled |
| 83 | GET | `/api/cron/predictive-maintenance` | Bearer (CRON_SECRET) | Daily |
| 84 | GET | `/api/cron/telegram-cleanup` | Bearer (CRON_SECRET) | Scheduled |

---

## 4. Frontend Pages in Scope

### 4.1 Public Pages

| # | URL | Description |
|---|-----|-------------|
| 1 | `/` | Homepage (trip search, hero, features) |
| 2 | `/login` | Login page |
| 3 | `/register` | Registration page |
| 4 | `/search` | Trip search results |
| 5 | `/book/[tripId]` | Booking flow (seats, passengers, payment) |
| 6 | `/tickets` | Ticket view (after booking) |
| 7 | `/track/[code]` | Public ticket/bus tracking |
| 8 | `/contact` | Contact page |
| 9 | `/about` | About page |
| 10 | `/faq` | FAQ page |
| 11 | `/privacy` | Privacy policy |
| 12 | `/terms` | Terms of service |
| 13 | `/verify/[shortCode]` | Ticket verification page |

### 4.2 Authenticated Pages

| # | URL | Role Required | Description |
|---|-----|--------------|-------------|
| 14 | `/admin/dashboard` | SUPER_ADMIN | Platform dashboard |
| 15 | `/admin/companies` | SUPER_ADMIN | Company management |
| 16 | `/admin/trips` | SUPER_ADMIN | Trip oversight |
| 17 | `/admin/bookings` | SUPER_ADMIN | Booking management |
| 18 | `/admin/manifests` | SUPER_ADMIN | Manifest management |
| 19 | `/admin/audit-logs` | SUPER_ADMIN | Audit trail |
| 20 | `/admin/platform-staff` | SUPER_ADMIN | Platform staff |
| 21 | `/admin/sales` | SUPER_ADMIN | Sales management |
| 22 | `/admin/analytics` | SUPER_ADMIN | Analytics dashboards |
| 23 | `/admin/messages` | SUPER_ADMIN | Company messaging |
| 24 | `/company/dashboard` | COMPANY_ADMIN | Company dashboard |
| 25 | `/company/trips` | COMPANY_ADMIN | Trip management |
| 26 | `/company/trips/[id]` | COMPANY_ADMIN | Trip detail (boarding, no-show) |
| 27 | `/company/trips/new` | COMPANY_ADMIN | Create new trip |
| 28 | `/company/staff` | COMPANY_ADMIN | Staff management |
| 29 | `/company/vehicles` | COMPANY_ADMIN | Vehicle management |
| 30 | `/company/fleet-analytics` | COMPANY_ADMIN | Fleet analytics dashboard |
| 31 | `/company/fleet-tracking` | COMPANY_ADMIN | Fleet map (live GPS) |
| 32 | `/company/reports` | COMPANY_ADMIN | Reports (maintenance, TCO, downtime) |
| 33 | `/company/work-orders` | COMPANY_ADMIN | Work order management |
| 34 | `/company/settings` | COMPANY_ADMIN | Company settings |
| 35 | `/company/messages` | COMPANY_ADMIN | Platform messaging |
| 36 | `/driver/track` | DRIVER | GPS tracking page |
| 37 | `/cashier/dashboard` | MANUAL_TICKETER | Manual ticketing |
| 38 | `/mechanic/dashboard` | MECHANIC | Inspections & work orders |
| 39 | `/finance/dashboard` | FINANCE | Financial reports |
| 40 | `/sales/dashboard` | SALES_PERSON | Referral dashboard |

---

## 5. Testing Boundaries

### 5.1 In Scope

- All web application pages and API endpoints listed above
- Authentication and session management
- Authorization and access control (RBAC, company segregation)
- Input validation and injection testing
- Payment flow security (TeleBirr callback verification)
- GPS tracking data handling
- Telegram bot security
- SMS webhook security
- File upload/download (manifests, receipts, profile pictures)
- CSP and security header effectiveness
- Rate limiting effectiveness
- Service worker behavior
- PWA manifest and caching

### 5.2 Out of Scope

| Item | Reason |
|------|--------|
| AWS EC2 infrastructure (OS, kernel) | Managed by AWS; separate infrastructure audit |
| Cloudflare configuration | Managed CDN service; separate Cloudflare audit |
| PostgreSQL server internals | Database engine security; separate database audit |
| TeleBirr payment gateway internals | Third-party service; separate TeleBirr audit |
| SMS Gateway internals | Third-party service |
| Telegram Bot API internals | Third-party service |
| Physical security of server | AWS managed data center |
| Social engineering | Not in scope for web application testing |
| DDoS testing | May impact production availability |

### 5.3 Testing Environment

| Environment | URL | Notes |
|------------|-----|-------|
| **Production** | https://i-ticket.et | Live system with real data; test carefully |
| **Origin IP** | http://54.147.33.168 | Direct server access (bypasses Cloudflare) |

> **Note**: There is no separate staging environment. Testing should be performed on production with test accounts. Avoid creating excessive test data or triggering real payments (use DEMO_MODE test accounts).

---

## 6. Contact Information for Testing Coordination

| Name | Role | Email | Phone |
|------|------|-------|-------|
| Abel Assefa | Platform Admin / CEO | [To be provided] | [To be provided] |
| [Technical Lead] | Developer Lead | [To be provided] | [To be provided] |

> **Note**: Please fill in the actual contact details before submission to INSA.

---

*End of Document 4.2.3 - Testing Scope Definition*
